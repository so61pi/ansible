---
- name: Creating Directory Structure
  file:
    path: "{{ item }}"
    state: directory
  with_items:
    - ~/.ssh
    - ~/work/media/images
    - ~/work/media/videos
    - ~/work/others
    - ~/work/programming/projects
    - ~/work/programming/sources
    - ~/work/tmp
    - ~/work/tools
    - ~/work/vms
    - ~/work/warehouse

- name: Moving ~/Downloads And ~/Documents
  block:
    - name: Moving Files
      command: mv "{{ item.src }}" "{{ item.dst }}"
      args:
        creates: "{{ item.dst }}"
      with_items:
        - { src : "~/Documents", dst : "~/work/documents" }
        - { src : "~/Downloads", dst : "~/work/downloads" }

    - name: Creating Symlinks
      file:
        src: "{{ item.src }}"
        dest: "{{ item.symlink }}"
        state: link
      with_items:
        - { src : "~/work/documents", symlink : "~/Documents" }
        - { src : "~/work/downloads", symlink : "~/Downloads" }

- name: Downloading FireFox And ThunderBird
  block:
    - command: wget -O firefox.tar.bz2 "{{ urls.mozilla.firefox }}"
        chdir: ~/work/tools
        creates: firefox.tar.bz2
    - command: wget -O thunderbird.tar.bz2 "{{ urls.mozilla.thunderbird }}"
        chdir: ~/work/tools
        creates: thunderbird.tar.bz2

- name: Cloning Oh-My-Zsh
  block:
    - git:
        repo: https://github.com/robbyrussell/oh-my-zsh
        dest: ~/.oh-my-zsh
    - debug:
        msg: Please run ~/.oh-my-zsh/master/tools/install.sh to install oh-my-zsh

- name: Configuring Git
  block:
    - stat:
        path: ~/.gitconfig
      register: p
    - block:
        - git_config:
            name: "{{ item.key }}"
            scope: global
            value: "{{ item.value }}"
          with_items:
            - { key: "alias.ggrep", value: "grep --break --heading --line-number" }
            - { key: "oh-my-zsh.hide-dirty", value: 1 }
            - { key: "user.useConfigOnly", value: true }
        - file:
            path: ~/.gitconfig
            attributes: "+i"
          become: true
          become_user: root
      when: not p.stat.exists
